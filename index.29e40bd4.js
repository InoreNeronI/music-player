class e extends React.Component{render(){return React.createElement("div",{id:"top-bar"},React.createElement(t,{title:this.props.title}))}}const t=({title:e})=>React.createElement("div",{id:"title"},React.createElement("h1",{id:"main-title"},e.main),React.createElement("h1",{id:"sub-title"},e.sub)),i=({waves:e,nLines:t,isPlaying:i,mute:a,end:n,loading:r})=>{let o=e.map(e=>React.createElement(s,{id:e.id,key:e.id,wHeight:e.wHeight,wMinHeight:e.wMinHeight,wWidth:e.wWidth,duration:e.duration,range:e.range,peakFreq:e.peakFreq,nLines:t,isPlaying:i,mute:a,end:n}));return React.createElement("div",{id:"sound-waves",className:r?"":"visible"},o)};class s extends React.Component{constructor(e){super(e),this.state={lineHeights:[],interval:0}}componentDidMount(){let{duration:e,peakFreq:t}=this.props;this.setLineHeights(!0,!1),setInterval(()=>{let e=this.state.interval%2==0,i=this.state.interval%t==0;this.setLineHeights(e,i),this.setState({interval:++this.state.interval})},e)}getNearestInterval(e,t,i){return Math.ceil(t/e)*e+(i?0:-1)}setLineHeights(e,t){let{nLines:i,wHeight:s,wMinHeight:a,wWidth:n,range:r,isPlaying:o,mute:d,end:l}=this.props,g=[],h=0,c=0,u=e?s:Math.round(s*(Math.random()+.01)),m=(n-1)/2,p=1/(m+1),v=this.getNearestInterval(n,Math.round(i*r.start),!0),E=this.getNearestInterval(n,Math.round(i*r.end),!1);t&&(u*=2);for(let e=0;e<i;e+=n){c=Math.floor(Math.random()*u),a?c+=a:c+=2;for(let t=0;t<n;t++)h=0,l||!o||e+t<v||e+t>E?h=2:t<m?h+=c*p*(t+1):t===m?h+=c:h+=c*(1-p*(t-m)),g.push(Math.round(h))}this.setState({lineHeights:g})}getSoundLines(){let e=[],{nLines:t,interval:i}=this.props;for(let i=0;i<t;i++){let t={height:this.state.lineHeights[i]+"px"},s=React.createElement("div",{key:i,className:"sound-line",style:t});e.push(s)}return e}render(){let{id:e}=this.props,t=this.getSoundLines();return React.createElement("div",{id:e,className:"sound-wave"},t)}}const a=e=>new Date(1e3*parseInt(e)).toISOString().slice(11,19).replace(/00:/g,""),n=(e,t)=>Math.floor(Math.random()*t)+e;class r extends React.PureComponent{render(){let{isPlaying:e,isDraggingTime:t,loading:i}=this.props,s=[],a=window.innerWidth/8;for(let i=0;i<a;i++){let a=n(1,window.innerWidth),r=n(40,60),o=n(0,1e3),d=t?n(100,400):n(500,1500),l=n(1,1e3),g=n(1,1e3),h={height:`${r}px`,left:`${a}px`,opacity:e?1:0,transform:`${l%2==0?"translateY(0%)":"translateY(-100%)"}`},c={animationName:`${l%2==0?"particle-down":"particle-up"}`,animationDelay:`${-1*o}ms`,animationDuration:`${d}ms`,height:`${g%2==0?"4px":"2px"}`,width:`${g%2==0?"4px":"2px"}`};s.push(React.createElement("div",{key:i,className:"particle-path",style:h},React.createElement("div",{className:"particle",style:c})))}return React.createElement("div",{id:"particles",className:i?"":"visible"},s)}}class o extends React.Component{constructor(e){super(e),this.setDraggingTime=this.setDraggingTime.bind(this),this.getCountFromPercentage=this.getCountFromPercentage.bind(this),this.handlePercentageOverride=this.handlePercentageOverride.bind(this),this.state={count:0,interval:null}}componentDidUpdate(e,t){e.isPlaying!==this.props.isPlaying&&(this.props.isPlaying?this.startTime():this.stopTime())}startTime(){let e=setInterval(()=>{this.setState({count:++this.state.count})},1e3);this.setState({interval:e})}stopTime(){clearInterval(this.state.interval)}getCountFromPercentage(){return Math.round(this.props.overridePercentage/100*this.props.tCount)}getPercentage(){if(this.props.isDraggingTime)return this.props.overridePercentage;if(this.props.overridePercentage>=0){let e=this.props.overridePercentage;return this.handlePercentageOverride(),e}return this.props.end?100:Math.min(this.state.count/this.props.tCount*100,100)}handlePercentageOverride(){let e=this.getCountFromPercentage();this.setState({count:e}),this.props.setOverridePercentage(-1),this.props.setAudioTime(e),this.props.end&&this.props.setSongEnded(!1)}setDraggingTime(e){this.props.setDraggingTime(e)}render(){let e=this.getPercentage(),{count:t}=this.state,i=a(this.props.end?this.props.tCount:t),s=a(this.props.tCount),{isPlaying:n,togglePlaying:r,mute:o,isDraggingTime:u,toggleMute:m,restartSong:p,setSongEnded:v,end:E}=this.props;return 0!==this.props.tCount&&t>=this.props.tCount&&(this.setState({count:0}),this.stopTime(),v(!0)),React.createElement("div",{id:"control-bar",className:u?"dragging":""},React.createElement(d,{percentage:e,setDraggingTime:this.setDraggingTime}),React.createElement(l,{isPlaying:n,togglePlaying:r,end:E}),React.createElement(g,{restartSong:()=>{p(),this.setState({count:0})}}),React.createElement(h,{mute:o,toggleMute:m}),React.createElement(c,{time:i,endTime:s}))}}const d=({percentage:e,setDraggingTime:t})=>React.createElement("div",{id:"progress-bar",className:"button"},React.createElement("div",{id:"filled",style:{width:`${e}%`}},React.createElement("div",{id:"dragger",onMouseDown:()=>{t(!0)}}))),l=({isPlaying:e,togglePlaying:t,end:i})=>React.createElement("div",{id:"play-toggle",className:e?"button toggled":"button",onClick:()=>{i||t(!e)}},React.createElement("div",{id:"play"},React.createElement("i",{className:"fa fa-play"})),React.createElement("div",{id:"pause"},React.createElement("i",{className:"fa fa-pause"}))),g=({restartSong:e})=>React.createElement("div",{id:"restart",className:"button",onClick:e},React.createElement("i",{className:"fa fa-undo"})),h=({mute:e,toggleMute:t})=>React.createElement("div",{id:"volume-toggle",className:e?"button toggled":"button",onClick:()=>{t(!e)}},React.createElement("div",{id:"volume-on"},React.createElement("i",{className:"fa fa-volume-up"})),React.createElement("div",{id:"volume-off"},React.createElement("i",{className:"fa fa-volume-off"}))),c=({time:e,endTime:t})=>React.createElement("div",{id:"control-bar-time"},React.createElement("h1",null,React.createElement("span",{id:"current-time"},e)," / ",React.createElement("span",{id:"end-time"},t)));class u extends React.Component{constructor(e){super(e),this.state={hide:!1}}componentDidUpdate(e,t){e.loading===this.props.loading||this.props.loading||setTimeout(()=>{this.setState({hide:!0})},1600)}render(){let e=this.props.loading?"visible":"done";return this.state.hide&&(e=`${e} hide`),React.createElement("div",{id:"loading",className:e},React.createElement("div",{id:"bars"},React.createElement("div",{className:"bar"}),React.createElement("div",{className:"bar"}),React.createElement("div",{className:"bar"})))}}class m extends React.Component{constructor(e){super(e),this.initAudio=this.initAudio.bind(this),this.togglePlaying=this.togglePlaying.bind(this),this.toggleMute=this.toggleMute.bind(this),this.setSongEnded=this.setSongEnded.bind(this),this.restartSong=this.restartSong.bind(this),this.setDraggingTime=this.setDraggingTime.bind(this),this.setOverridePercentage=this.setOverridePercentage.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseAway=this.handleMouseAway.bind(this),this.setAudioTime=this.setAudioTime.bind(this),this.setDefaultAudioSettings=this.setDefaultAudioSettings.bind(this);let t=Math.floor(window.innerWidth/20);this.state={title:{main:"Alive",sub:"Simon More"},loading:!0,isDraggingTime:!1,isPlaying:!1,mute:!1,end:!1,tCount:0,nLines:t,waves:[{id:"wave-1",nLines:t,wHeight:150,wWidth:5,duration:150,range:{start:.1,end:.3},peakFreq:5},{id:"wave-2",nLines:t,wHeight:150,wWidth:5,duration:150,range:{start:.6,end:.9},peakFreq:5},{id:"wave-3",nLines:t,wHeight:50,wWidth:7,duration:100,range:{start:0,end:1},peakFreq:7}],audio:null,overridePercentage:-1}}componentDidMount(){this.initAudio()}initAudio(){let e=new Audio("https://s3-us-west-2.amazonaws.com/s.cdpn.io/1468070/SimonMoreAlive.mp3");if(e)try{e.addEventListener("loadedmetadata",()=>{setTimeout(()=>{e.muted=this.state.mute,e.play(),this.setState({audio:e,tCount:Math.round(e.duration),loading:!1}),this.restartSong()},1e3)}),e.addEventListener("error",()=>{this.setDefaultAudioSettings()})}catch(e){this.setDefaultAudioSettings()}else this.setDefaultAudioSettings()}setDefaultAudioSettings(){this.setState({tCount:240,isPlaying:!0,loading:!1})}togglePlaying(e){this.state.audio&&(e?this.state.audio.play():this.state.audio.pause()),this.setState({isPlaying:e})}toggleMute(e){this.state.audio&&(this.state.audio.muted=e),this.setState({mute:e})}setSongEnded(e){this.setState({end:e}),this.togglePlaying(!e)}restartSong(){this.setState({end:!1,isPlaying:!0,mute:!1}),this.state.audio&&(this.state.audio.muted=!1,this.state.audio.currentTime=0,this.state.audio.play())}handleMouseMove(e){if(this.state.isDraggingTime){let t=Math.round(100*(e.clientX/window.innerWidth).toFixed(2));this.setOverridePercentage(t)}}handleMouseAway(){this.setDraggingTime(!1)}setDraggingTime(e){this.setState({isDraggingTime:e})}setOverridePercentage(e){this.setState({overridePercentage:e})}setAudioTime(e){this.state.audio&&(this.state.audio.currentTime=e)}render(){return React.createElement("div",{id:"music-app",onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseAway,onMouseLeave:this.handleMouseAway},React.createElement(u,{loading:this.state.loading}),React.createElement(e,{title:this.state.title}),React.createElement(i,{waves:this.state.waves,nLines:this.state.nLines,isPlaying:this.state.isPlaying,mute:this.state.mute,end:this.state.end,loading:this.state.loading}),React.createElement(r,{isPlaying:this.state.isPlaying,loading:this.state.loading,isDraggingTime:this.state.isDraggingTime}),React.createElement(o,{tCount:this.state.tCount,isPlaying:this.state.isPlaying,togglePlaying:this.togglePlaying,mute:this.state.mute,toggleMute:this.toggleMute,setSongEnded:this.setSongEnded,restartSong:this.restartSong,end:this.state.end,isDraggingTime:this.state.isDraggingTime,setDraggingTime:this.setDraggingTime,overridePercentage:this.state.overridePercentage,setOverridePercentage:this.setOverridePercentage,setAudioTime:this.setAudioTime}))}}ReactDOM.render(React.createElement(m,null),document.getElementById("root"));